<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>FeatureBench</title>
    <link rel="icon" type="image/jpeg" href="./leaderboard/logos/logo.jpg" />
    <meta
      name="description"
      content="FeatureBench is an execution-based benchmark for end-to-end, feature-oriented agentic coding."
    />
    <script>
      (() => {
        let stored = null;
        try {
          stored = localStorage.getItem("featurebench.theme");
        } catch {
          stored = null;
        }
        const prefersDark =
          window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
        const theme =
          stored === "dark" || stored === "light" ? stored : prefersDark ? "dark" : "light";
        document.documentElement.dataset.theme = theme;
      })();
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@500;600;700;800&family=Plus+Jakarta+Sans:wght@500;600;700;800&family=Sora:wght@600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./assets/css/topbar.css" />
    <style>
      :root {
        color-scheme: light;
        --bg: #f7f8fb;
        --surface: #ffffff;
        --text: #0f1728;
        --muted: #586276;
        --line: #dde4ef;
        --line-strong: #c4cfde;
        --accent: #0f1728;
        --accent-soft: #2f5dff;
        --focus: #2f5dff;
        --hero-title-soft: #8f6325;
        --card-shadow: 0 16px 46px rgba(15, 23, 40, 0.08);
        --hero-wave-fill: rgba(193, 202, 217, 0.3);
        --hero-wave-shadow: rgba(124, 136, 159, 0.26);
        --font-ui: "Manrope", "Segoe UI", -apple-system, BlinkMacSystemFont, sans-serif;
        --font-head: "Sora", "Plus Jakarta Sans", "Manrope", "Segoe UI", -apple-system, BlinkMacSystemFont, sans-serif;
      }

      html[data-theme="dark"] {
        color-scheme: dark;
        --bg: #0b1220;
        --surface: #101a2c;
        --text: #e8eefb;
        --muted: #9aa8c0;
        --line: #24344f;
        --line-strong: #345076;
        --accent: #e8eefb;
        --accent-soft: #8db0ff;
        --focus: #8db0ff;
        --hero-title-soft: #386aa6;
        --card-shadow: 0 22px 54px rgba(1, 4, 12, 0.45);
        --hero-wave-fill: rgba(58, 83, 123, 0.34);
        --hero-wave-shadow: rgba(109, 144, 206, 0.32);
      }

      * {
        box-sizing: border-box;
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      *::-webkit-scrollbar {
        width: 0 !important;
        height: 0 !important;
        display: none;
      }

      html,
      body {
        height: 100%;
        margin: 0;
        min-height: 100%;
      }

      html {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      html::-webkit-scrollbar {
        width: 0;
        height: 0;
      }

      body {
        font-family: var(--font-ui);
        color: var(--text);
        background:
          radial-gradient(820px 420px at 10% -20%, rgba(79, 117, 255, 0.12), transparent 70%),
          radial-gradient(740px 420px at 88% -18%, rgba(57, 103, 255, 0.1), transparent 72%),
          var(--bg);
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      body::-webkit-scrollbar {
        width: 0;
        height: 0;
      }

      a {
        color: inherit;
        text-decoration: none;
      }

      .shell {
        width: 100%;
        margin: 0 auto;
        height: 100vh;
        min-height: 100dvh;
        height: 100dvh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      .slides {
        width: 100%;
        margin: 0;
        flex: 1;
        height: 100%;
        min-height: 0;
        overflow-y: auto;
        overflow-x: hidden;
        scroll-snap-type: y mandatory;
        scroll-behavior: smooth;
        overscroll-behavior: contain;
        padding-bottom: 0;
      }

      .screen {
        min-height: 100%;
        scroll-snap-align: start;
        scroll-snap-stop: always;
        padding: clamp(10px, 2vh, 24px) clamp(20px, 4.8vw, 92px) clamp(14px, 2.6vh, 34px);
      }

      .intro-fold {
        display: flex;
        flex-direction: column;
        min-height: 100%;
      }

      .screen > .story-panel {
        margin-inline: auto;
      }

      .resource-pill:focus-visible {
        outline: 2px solid var(--focus);
        outline-offset: 2px;
      }

      .hero {
        margin-top: 0;
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        position: relative;
        isolation: isolate;
        padding-top: clamp(14px, 2.2vh, 28px);
        padding-bottom: clamp(22px, 4.6vh, 48px);
        overflow: hidden;
      }

      .hero::after {
        content: none;
      }

      .hero-copy {
        margin-top: clamp(48px, 10vh, 150px);
      }

      .kicker {
        margin: 0;
        font-size: 12px;
        font-weight: 700;
        letter-spacing: 0.14em;
        text-transform: uppercase;
        color: var(--muted);
      }

      .hero h1 {
        margin: 16px 0 18px;
        font-family: var(--font-head);
        font-size: clamp(2rem, 4.9vw, 4.36rem);
        line-height: 1.02;
        letter-spacing: -0.024em;
        font-weight: 700;
        max-width: 16ch;
        text-wrap: pretty;
      }

      .hero h1 span {
        display: block;
      }

      .hero h1 span + span {
        margin-top: 0.36em;
      }

      .hero-brand {
        text-decoration-line: underline;
        text-decoration-thickness: 0.045em;
        text-underline-offset: 0.18em;
        text-decoration-color: color-mix(in srgb, var(--line-strong) 70%, transparent 30%);
      }

      .hero-soft {
        color: var(--hero-title-soft);
        font-style: normal;
      }

      html[data-theme="dark"] .hero-soft {
        text-shadow: 0 0 18px rgba(212, 176, 114, 0.16);
      }

      .hero p {
        margin: 0;
        max-width: 64ch;
        font-size: clamp(1.02rem, 2.3vw, 1.24rem);
        line-height: 1.58;
        color: var(--muted);
      }

      .hero p + p {
        margin-top: 2px;
      }

      .hero-wave {
        position: absolute;
        left: -2%;
        right: -2%;
        bottom: clamp(92px, 13vh, 220px);
        height: clamp(54%, 60%, 68%);
        pointer-events: none;
        z-index: -1;
      }

      .hero-wave svg {
        width: 100%;
        height: 100%;
        display: block;
        transform-origin: 50% 100%;
        animation: hero-wave-breathe 11s ease-in-out infinite;
        will-change: transform;
      }

      .hero-wave-fill {
        fill: var(--hero-wave-fill);
        animation: hero-wave-fill 11s ease-in-out infinite;
        transform-origin: 50% 100%;
        will-change: transform, opacity;
      }

      .hero-wave-shadow {
        fill: none;
        stroke: var(--hero-wave-shadow);
        stroke-width: 8;
        stroke-linecap: round;
        stroke-linejoin: round;
        opacity: 0.6;
        filter: blur(3.2px);
        animation: hero-wave-shadow 9s ease-in-out infinite;
        transform-origin: 50% 100%;
        will-change: transform, opacity, filter;
      }

      .stats {
        margin-top: clamp(-118px, -11.5vh, -46px);
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 12px;
      }

      .stat-card {
        padding: 20px;
        border-radius: 14px;
        border: 1px solid var(--line);
        background: color-mix(in srgb, var(--surface) 92%, transparent 8%);
        box-shadow: var(--card-shadow);
      }

      .stat-label {
        margin: 0;
        font-size: 14px;
        line-height: 1.3;
        font-weight: 700;
        color: var(--muted);
      }

      .stat-value {
        margin: 10px 0 6px;
        font-family: var(--font-head);
        font-size: clamp(2rem, 4vw, 2.35rem);
        line-height: 1;
        letter-spacing: -0.02em;
      }

      .stat-sub {
        margin: 0;
        font-size: 14px;
        line-height: 1.45;
        color: var(--muted);
      }

      .resource-row {
        margin-top: clamp(6px, 1.2vh, 12px);
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }

      .resource-pill {
        height: 42px;
        padding: 0 14px;
        border-radius: 999px;
        border: 1px solid var(--line);
        background: var(--surface);
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        line-height: 1;
        font-weight: 700;
      }

      .resource-main {
        display: inline-flex;
        align-items: center;
        gap: 7px;
        min-width: 0;
      }

      .resource-icon {
        width: 18px;
        height: 18px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }

      .resource-icon svg {
        width: 18px;
        height: 18px;
        display: block;
      }

      .resource-icon img {
        width: 18px;
        height: 18px;
        display: block;
        object-fit: contain;
      }

      .resource-name {
        white-space: nowrap;
        color: var(--text);
      }

      .resource-value {
        color: var(--muted);
        font-weight: 600;
      }

      .resource-icon .provider-github {
        color: var(--text);
      }

      .more-content {
        margin-top: 0;
        padding-top: 0;
        padding-bottom: 0;
        display: grid;
        gap: 26px;
        justify-items: center;
      }

      .more-intro {
        width: min(1320px, 100%);
        max-width: none;
      }

      .more-kicker {
        margin: 0;
        font-size: 12px;
        letter-spacing: 0.14em;
        text-transform: uppercase;
        font-weight: 700;
        color: var(--muted);
      }

      .more-content h2 {
        margin: 10px 0 12px;
        font-family: var(--font-head);
        font-size: clamp(1.4rem, 2.3vw, 1.92rem);
        line-height: 1.15;
        letter-spacing: -0.02em;
      }

      .more-intro p {
        margin: 0;
        max-width: none;
        color: var(--muted);
        font-size: 1rem;
        line-height: 1.6;
      }

      .story-panel {
        border-top: 1px solid var(--line);
        padding-top: 20px;
        width: min(1320px, 100%);
        display: grid;
        gap: 10px;
      }

      .story-panel.no-divider {
        border-top: 1px solid transparent;
        padding-top: 20px;
      }

      .story-kicker {
        margin: 0;
        font-size: 11px;
        letter-spacing: 0.13em;
        text-transform: uppercase;
        font-weight: 700;
        color: var(--muted);
      }

      .story-panel h3 {
        margin: 8px 0 8px;
        font-family: var(--font-head);
        font-size: clamp(1.14rem, 1.65vw, 1.44rem);
        letter-spacing: -0.012em;
      }

      .story-panel p {
        margin: 0;
        color: var(--muted);
        line-height: 1.62;
        font-size: 0.98rem;
      }

      .story-list {
        margin: 6px 0 0;
        padding: 0 0 0 18px;
        display: grid;
        gap: 6px;
      }

      .story-list li {
        color: color-mix(in srgb, var(--muted) 94%, var(--text) 6%);
        line-height: 1.5;
      }

      .pipeline-panel {
        gap: 6px;
        --pipeline-body-size: clamp(1.2rem, 1.46vw, 1.34rem);
        --pipeline-list-size: clamp(1.08rem, 1.3vw, 1.22rem);
        --pipeline-body-line-height: 1.7;
        min-height: clamp(600px, 78vh, 860px);
        grid-template-rows: auto 1fr;
      }

      .pipeline-panel .story-kicker {
        font-size: clamp(1.46rem, 2.3vw, 1.98rem);
        letter-spacing: 0.08em;
        font-weight: 800;
        color: color-mix(in srgb, var(--text) 88%, var(--muted) 12%);
        margin-bottom: 2px;
      }

      .pipeline-panel h3 {
        font-size: clamp(1.42rem, 1.95vw, 1.82rem);
        line-height: 1.38;
        margin: 0;
        color: var(--text);
        font-weight: 700;
        max-width: min(96ch, 100%);
      }

      .pipeline-layout {
        display: grid;
        grid-template-columns: minmax(0, 1.06fr) minmax(0, 0.94fr);
        gap: clamp(18px, 2.8vw, 34px);
        margin-top: 0;
        align-items: center;
        min-height: clamp(470px, 62vh, 700px);
      }

      .pipeline-copy {
        display: grid;
        gap: 12px;
        font-size: var(--pipeline-body-size);
        line-height: var(--pipeline-body-line-height);
        align-content: center;
        min-height: 100%;
      }

      .pipeline-copy h3 {
        margin: 0 0 2px;
      }

      .pipeline-panel .pipeline-lead {
        margin: 0;
        color: var(--muted);
        font-size: var(--pipeline-body-size) !important;
        line-height: var(--pipeline-body-line-height) !important;
        max-width: none;
      }

      .pipeline-panel .pipeline-list {
        margin: 0;
        padding-left: 20px;
        gap: 10px;
        font-size: var(--pipeline-list-size);
        line-height: var(--pipeline-body-line-height);
      }

      .pipeline-panel .pipeline-list li {
        font-size: var(--pipeline-list-size) !important;
        line-height: var(--pipeline-body-line-height) !important;
      }

      .dataset-card {
        margin: 0;
        align-self: center;
        justify-self: stretch;
        display: grid;
        justify-items: center;
        gap: 8px;
        border: 0;
        background: transparent;
        padding: 0;
        transform: translateY(-22px);
        width: 100%;
      }

      .dataset-card .story-caption {
        margin-top: 2px;
        font-size: clamp(1.02rem, 1.16vw, 1.14rem);
        line-height: 1.55;
        color: color-mix(in srgb, var(--text) 86%, var(--muted) 14%);
      }

      .dataset-donut-shell {
        border: 0;
        background: transparent;
        padding: 0;
        width: 100%;
        display: grid;
        place-items: center;
      }

      .dataset-chart-wrap {
        position: relative;
        width: min(740px, 100%);
        aspect-ratio: 1 / 1;
        max-width: none;
        margin: 0 auto;
      }

      .dataset-donut {
        width: 100%;
        height: 100%;
        display: block;
      }

      .dataset-slice {
        stroke: color-mix(in srgb, var(--surface) 96%, transparent 4%);
        stroke-width: 1.4;
        transition: transform 180ms ease, filter 180ms ease, opacity 180ms ease;
        transform-origin: 50% 50%;
        cursor: pointer;
        outline: none;
      }

      .dataset-slice:hover,
      .dataset-slice:focus-visible,
      .dataset-slice.active {
        transform: scale(1.015);
        filter: brightness(1.08);
        opacity: 1;
      }

      .dataset-center {
        position: absolute;
        inset: 50% auto auto 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        pointer-events: none;
      }

      .dataset-center-kicker {
        margin: 0;
        color: var(--muted);
        font-size: 0.78rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        font-weight: 700;
      }

      .dataset-center-title {
        margin: 6px 0 0;
        font-family: var(--font-head);
        font-size: clamp(1.28rem, 2vw, 1.7rem);
        line-height: 1.05;
      }

      .dataset-center-sub {
        margin: 4px 0 0;
        color: var(--muted);
        font-family: var(--font-mono);
        font-size: 0.78rem;
      }

      .dataset-tooltip {
        position: absolute;
        left: 0;
        top: 0;
        transform: translate(-9999px, -9999px);
        z-index: 2;
        padding: 7px 9px;
        border: 1px solid var(--line);
        background: color-mix(in srgb, var(--surface) 95%, var(--surface-soft) 5%);
        color: var(--text);
        font-family: var(--font-mono);
        font-size: 12px;
        line-height: 1.25;
        white-space: nowrap;
        pointer-events: none;
      }

      .dataset-slice:focus,
      .dataset-slice:focus-visible {
        outline: none;
      }

      .dataset-tooltip.visible {
        transform: translate(0, 0);
      }

      .dataset-hover {
        margin: 10px 0 0;
        color: var(--muted);
        font-size: clamp(0.8rem, 0.92vw, 0.88rem);
        line-height: 1.5;
        text-align: center;
      }

      .story-media {
        width: min(560px, 100%);
        margin: 8px auto 0;
        border: 0;
        background: transparent;
      }

      .story-media img {
        width: auto;
        max-width: 100%;
        max-height: 380px;
        height: auto;
        display: block;
        margin: 0 auto;
      }

      .story-caption {
        margin: 10px auto 0;
        max-width: min(560px, 100%);
        padding: 0;
        border-top: 0;
        color: var(--muted);
        font-size: 0.86rem;
        line-height: 1.45;
        text-align: center;
      }

      .story-media-row {
        width: min(860px, 100%);
        margin: 8px auto 0;
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 12px;
        align-items: start;
      }

      .story-media-row .story-media {
        width: 100%;
        margin: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .story-media-row .story-media img {
        width: 100%;
        height: 280px;
        max-height: none;
        object-fit: contain;
        object-position: center top;
      }

      .story-media-row .story-caption {
        max-width: none;
        margin: 8px 0 0;
      }

      .story-facts {
        margin-top: 6px;
        display: grid;
        grid-template-columns: repeat(4, minmax(0, max-content));
        gap: 8px;
        align-items: center;
      }

      .story-fact {
        border: 1px solid var(--line);
        background: color-mix(in srgb, var(--surface) 95%, transparent 5%);
        padding: 6px 10px;
        display: inline-flex;
        align-items: baseline;
        gap: 6px;
      }

      .fact-value {
        margin: 0;
        font-family: var(--font-head);
        font-size: 1rem;
        line-height: 1;
      }

      .fact-label {
        margin: 0;
        color: var(--muted);
        font-size: 0.78rem;
        line-height: 1.2;
      }

      .paper-table-wrap {
        width: min(1320px, 100%);
        margin: 8px auto 0;
        overflow-x: auto;
      }

      .paper-table {
        width: 100%;
        border-collapse: collapse;
        min-width: 820px;
      }

      .paper-table th,
      .paper-table td {
        border: 1px solid var(--line);
        padding: 8px 10px;
        font-size: 0.86rem;
        line-height: 1.35;
        text-align: left;
        white-space: nowrap;
      }

      .paper-table th {
        background: color-mix(in srgb, var(--surface) 78%, var(--line) 22%);
        color: var(--text);
        font-weight: 700;
      }

      .paper-table thead tr:first-child th {
        background: color-mix(in srgb, var(--surface) 88%, var(--line) 12%);
        font-size: 1rem;
        letter-spacing: 0.01em;
        text-align: center;
        border-bottom: 0;
        padding-top: 10px;
        padding-bottom: 6px;
      }

      .paper-table thead tr:first-child th.paper-col-stub {
        text-align: left;
        vertical-align: middle;
        padding-top: 0;
        padding-bottom: 0;
      }

      .paper-table thead tr:nth-child(2) th {
        background: color-mix(in srgb, var(--surface) 80%, var(--line) 20%);
        border-top: 0;
      }

      .paper-table thead tr:first-child th.paper-group-head {
        position: relative;
      }

      .paper-table thead tr:first-child th.paper-group-head::after {
        content: "";
        position: absolute;
        left: 20px;
        right: 20px;
        bottom: 5px;
        height: 1px;
        background: color-mix(in srgb, var(--line) 72%, transparent 28%);
        opacity: 0.62;
      }

      .paper-table .paper-group-start {
        border-left: 1px solid var(--line);
      }

      .paper-table td:nth-child(n + 3),
      .paper-table th.paper-metric {
        text-align: center;
      }

      .paper-table td:nth-child(3),
      .paper-table td:nth-child(6) {
        border-left: 1px solid var(--line);
      }

      .paper-table tbody tr:nth-child(even) {
        background: color-mix(in srgb, var(--surface) 86%, transparent 14%);
      }

      .paper-footnote {
        margin: 8px 0 0;
        color: var(--muted);
        font-size: 0.8rem;
        line-height: 1.35;
      }

      .paper-footnote sup {
        font-size: 0.72em;
      }

      .results-panel {
        --results-body-size: clamp(1.2rem, 1.46vw, 1.34rem);
        --results-body-line-height: 1.7;
        width: 100%;
        display: flex;
        flex-direction: column;
        min-height: 100%;
        gap: 6px;
      }

      .results-panel .story-kicker {
        font-size: clamp(1.46rem, 2.3vw, 1.98rem);
        letter-spacing: 0.08em;
        font-weight: 800;
        color: color-mix(in srgb, var(--text) 88%, var(--muted) 12%);
        margin-bottom: 2px;
        width: 100%;
        max-width: 1320px;
        margin-left: auto;
        margin-right: auto;
      }

      .results-panel .results-body {
        flex: 1;
        display: grid;
        align-content: center;
        gap: 10px;
      }

      .results-panel h3 {
        font-size: clamp(1.42rem, 1.95vw, 1.82rem);
        line-height: 1.38;
        margin: 0;
        color: var(--text);
        font-weight: 700;
        max-width: min(96ch, 100%);
      }

      .results-panel .results-body > h3,
      .results-panel .results-body > p,
      .results-panel .story-facts,
      .results-panel .paper-table-wrap,
      .results-panel .paper-footnote {
        width: 100%;
        max-width: 1320px;
        margin-left: auto;
        margin-right: auto;
      }

      .results-panel .results-body > p:not(.paper-footnote) {
        font-size: var(--results-body-size);
        line-height: var(--results-body-line-height);
      }

      .results-panel .story-facts {
        margin-top: 10px;
      }

      .results-panel .results-body > p.paper-footnote {
        font-size: clamp(1rem, 1.2vw, 1.12rem);
        line-height: 1.4;
      }

      .results-screen {
        display: flex;
        align-items: stretch;
      }

      .results-screen > .story-panel {
        width: 100%;
      }

      .citation-panel {
        gap: 12px;
      }

      .citation-panel .story-kicker {
        font-size: clamp(1.46rem, 2.3vw, 1.98rem);
        letter-spacing: 0.08em;
        font-weight: 800;
        color: color-mix(in srgb, var(--text) 88%, var(--muted) 12%);
        margin-bottom: 2px;
      }

      .citation-panel > p {
        margin: 0;
        color: var(--muted);
        font-size: clamp(1.02rem, 1.2vw, 1.12rem);
        line-height: 1.65;
      }

      .citation-grid {
        margin-top: 4px;
        display: grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 12px;
      }

      .citation-card {
        border: 1px solid var(--line);
        background: color-mix(in srgb, var(--surface) 94%, transparent 6%);
        display: grid;
        grid-template-rows: auto 1fr;
        min-height: 240px;
      }

      .citation-card-head {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
        padding: 10px 12px;
        border-bottom: 1px solid var(--line);
        background: color-mix(in srgb, var(--surface) 84%, var(--line) 16%);
      }

      .citation-card-head h4 {
        margin: 0;
        font-family: var(--font-head);
        font-size: 1rem;
        line-height: 1.2;
        letter-spacing: 0.01em;
      }

      .citation-copy-btn {
        height: 30px;
        padding: 0 10px;
        border: 1px solid var(--line-strong);
        background: var(--surface);
        color: var(--text);
        font: inherit;
        font-size: 0.82rem;
        font-weight: 700;
        letter-spacing: 0.01em;
        cursor: pointer;
        transition: border-color 160ms ease, background-color 160ms ease, color 160ms ease;
      }

      .citation-copy-btn:hover {
        border-color: var(--focus);
      }

      .citation-copy-btn:focus-visible {
        outline: 2px solid var(--focus);
        outline-offset: 2px;
      }

      .citation-copy-btn[data-copied="true"] {
        border-color: color-mix(in srgb, var(--focus) 70%, var(--line-strong) 30%);
        background: color-mix(in srgb, var(--focus) 16%, var(--surface) 84%);
      }

      .citation-code {
        margin: 0;
        padding: 12px 12px 14px;
        color: var(--text);
        font-family: "SFMono-Regular", Menlo, Consolas, Monaco, "Liberation Mono", monospace;
        font-size: 0.8rem;
        line-height: 1.5;
        white-space: pre-wrap;
        overflow-wrap: anywhere;
      }

      [data-reveal] {
        opacity: 0;
        transform: translateY(16px);
        animation: rise 620ms ease forwards;
        animation-delay: var(--delay, 0ms);
      }

      @keyframes rise {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes hero-wave-breathe {
        0%,
        100% {
          transform: translate3d(0, 0, 0) scale(1, 1);
        }
        50% {
          transform: translate3d(-0.6%, -3px, 0) scale(1.012, 1.014);
        }
      }

      @keyframes hero-wave-fill {
        0%,
        100% {
          opacity: 0.96;
          transform: translate3d(0, 0, 0);
        }
        50% {
          opacity: 1;
          transform: translate3d(0.25%, -2px, 0);
        }
      }

      @keyframes hero-wave-shadow {
        0%,
        100% {
          opacity: 0.56;
          filter: blur(3.2px);
          transform: translate3d(0, 0, 0);
        }
        50% {
          opacity: 0.76;
          filter: blur(4.5px);
          transform: translate3d(0.6%, -4px, 0);
        }
      }

      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        border: 0;
      }

      .screen-dots {
        position: fixed;
        right: 16px;
        top: 50%;
        transform: translateY(-50%);
        z-index: 38;
        display: grid;
        gap: 9px;
        padding: 8px 6px;
        border: 1px solid color-mix(in srgb, var(--line) 84%, transparent 16%);
        border-radius: 999px;
        background: color-mix(in srgb, var(--surface) 84%, transparent 16%);
        backdrop-filter: blur(8px);
      }

      .screen-dot {
        width: 8px;
        height: 8px;
        border-radius: 999px;
        border: 1px solid color-mix(in srgb, var(--line-strong) 70%, transparent 30%);
        background: transparent;
        padding: 0;
        cursor: pointer;
        transition: transform 150ms ease, background-color 150ms ease, border-color 150ms ease;
      }

      .screen-dot.active {
        background: var(--accent-soft);
        border-color: var(--accent-soft);
        transform: scale(1.2);
      }

      .screen-dot:focus-visible {
        outline: 2px solid var(--focus);
        outline-offset: 2px;
      }

      @media (max-width: 980px) {
        .screen-dots {
          right: 10px;
          gap: 8px;
        }

        .results-screen {
          align-items: flex-start;
        }

        .intro-fold {
          min-height: auto;
        }

        .stats {
          margin-top: clamp(10px, 1.8vh, 18px);
          grid-template-columns: 1fr;
        }

        .hero-wave {
          bottom: clamp(34px, 7vh, 110px);
          height: clamp(52%, 58%, 66%);
        }

        .story-facts {
          grid-template-columns: repeat(2, minmax(0, max-content));
        }

        .story-media-row {
          grid-template-columns: 1fr;
        }

        .story-media-row .story-media img {
          height: auto;
          max-height: 340px;
        }

        .pipeline-layout {
          grid-template-columns: 1fr;
          gap: 16px;
          align-items: start;
          min-height: auto;
          margin-top: 6px;
        }

        .dataset-chart-wrap {
          max-width: 420px;
        }

        .pipeline-copy {
          align-content: start;
          min-height: auto;
        }

        .dataset-card {
          transform: none;
        }

        .citation-grid {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }
      }

      @media (max-width: 780px) {
        .slides {
          width: 100%;
        }

        .hero {
          padding-bottom: 14px;
        }

        .hero-copy {
          margin-top: clamp(12px, 3vh, 32px);
        }

        .kicker {
          margin-top: 0;
        }

        .resource-pill {
          height: 34px;
          padding: 0 11px;
          font-size: 13px;
          gap: 7px;
        }

        .resource-icon,
        .resource-icon svg,
        .resource-icon img {
          width: 16px;
          height: 16px;
        }

        .screen-dots {
          display: none;
        }

        .story-panel {
          padding-top: 22px;
        }

        .story-facts {
          grid-template-columns: 1fr;
          justify-items: start;
        }

        .citation-grid {
          grid-template-columns: 1fr;
        }

        .citation-card {
          min-height: 210px;
        }

      }

      @media (prefers-reduced-motion: reduce) {
        [data-reveal] {
          opacity: 1;
          transform: none;
          animation: none;
        }

        .hero-wave svg,
        .hero-wave-fill,
        .hero-wave-shadow {
          animation: none;
          transform: none;
          filter: blur(3.2px);
        }
      }
    </style>
  </head>
  <body>
    <div class="shell">
      <header class="topbar" data-reveal style="--delay: 20ms">
        <div class="topbar-content">
          <div class="topbar-left">
            <a class="brand-home" href="./" aria-current="page">
              <img src="./leaderboard/logos/logo.jpg" alt="FeatureBench fox logo" />
              <span>FeatureBench</span>
            </a>

            <nav class="main-nav" aria-label="Primary">
              <a href="./leaderboard/">Leaderboard</a>
              <a href="./tasks/">Tasks</a>
              <a href="./news/">News</a>
            </nav>
          </div>

          <div class="topbar-right" aria-label="Theme and links">
            <button
              class="icon-btn"
              id="themeLight"
              type="button"
              aria-label="Use light theme"
              aria-pressed="false"
              title="Light"
            >
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <circle cx="12" cy="12" r="4.5" stroke="currentColor" stroke-width="1.9" />
                <path
                  d="M12 2.5v2.3M12 19.2v2.3M4.9 4.9l1.6 1.6M17.5 17.5l1.6 1.6M2.5 12h2.3M19.2 12h2.3M4.9 19.1l1.6-1.6M17.5 6.5l1.6-1.6"
                  stroke="currentColor"
                  stroke-width="1.9"
                  stroke-linecap="round"
                />
              </svg>
              <span class="sr-only">Light theme</span>
            </button>

            <button
              class="icon-btn"
              id="themeDark"
              type="button"
              aria-label="Use dark theme"
              aria-pressed="false"
              title="Dark"
            >
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path
                  d="M20 14.4a8.7 8.7 0 1 1-10.4-10.4A7 7 0 0 0 20 14.4Z"
                  stroke="currentColor"
                  stroke-width="1.9"
                  stroke-linejoin="round"
                />
              </svg>
              <span class="sr-only">Dark theme</span>
            </button>

            <a
              class="icon-btn"
              href="https://github.com/LiberCoders/FeatureBench"
              target="_blank"
              rel="noopener noreferrer"
              aria-label="Open GitHub"
              title="GitHub"
            >
              <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path
                  d="M12 .5a12 12 0 0 0-3.79 23.39c.6.11.82-.26.82-.58v-2.2c-3.34.73-4.04-1.42-4.04-1.42-.55-1.39-1.33-1.76-1.33-1.76-1.09-.74.09-.73.09-.73 1.2.08 1.83 1.23 1.83 1.23 1.08 1.84 2.82 1.31 3.5 1 .11-.78.42-1.31.76-1.61-2.67-.3-5.47-1.34-5.47-5.95 0-1.31.47-2.39 1.23-3.23-.12-.31-.53-1.54.12-3.21 0 0 1.01-.32 3.3 1.23A11.4 11.4 0 0 1 12 6.8c1.01 0 2.03.14 2.98.42 2.29-1.55 3.3-1.23 3.3-1.23.65 1.67.24 2.9.12 3.21.77.84 1.23 1.92 1.23 3.23 0 4.62-2.81 5.64-5.49 5.94.43.38.81 1.13.81 2.28v3.38c0 .32.22.7.82.58A12 12 0 0 0 12 .5Z"
                />
              </svg>
              <span class="sr-only">GitHub</span>
            </a>
          </div>
        </div>
      </header>

      <main id="slides" class="slides">
        <section class="screen intro-fold" aria-label="Hero Fold">
          <section class="hero" data-reveal style="--delay: 120ms">
            <div class="hero-copy">
              <p class="kicker">Feature-Oriented Agentic Coding Benchmark</p>
              <h1>
                <span class="hero-brand">FeatureBench:</span>
                <span>Beyond <em class="hero-soft">bug</em> fixing.</span>
                <span>Ship real <em class="hero-soft">features</em>.</span>
              </h1>
              <p>
                End-to-end benchmarking of real-world feature development.
              </p>
              <p>
                Tasks from real repositories, evaluated by executable tests.
              </p>
            </div>
            <div class="hero-wave" aria-hidden="true">
              <svg viewBox="0 0 1200 340" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  class="hero-wave-fill"
                  d="M0 322 C160 316 320 304 500 286 C670 268 760 236 840 178 C915 122 990 86 1088 68 C1146 58 1182 52 1200 50 L1200 340 L0 340 Z"
                />
                <path
                  class="hero-wave-shadow"
                  d="M-10 322 C150 316 320 304 500 286 C670 268 760 236 840 178 C915 122 990 86 1088 68 C1146 58 1182 52 1210 50"
                />
              </svg>
            </div>
          </section>

          <section class="stats" data-reveal style="--delay: 200ms" aria-label="Leaderboard Snapshot">
            <article class="stat-card">
              <p class="stat-label">Best %Resolved (Full)</p>
              <p class="stat-value" id="resolvedBest">--</p>
              <p class="stat-sub" id="resolvedSub">Loading latest results...</p>
            </article>

            <article class="stat-card">
              <p class="stat-label">Best %Passed (Full)</p>
              <p class="stat-value" id="fullBest">--</p>
              <p class="stat-sub" id="fullSub">Loading latest results...</p>
            </article>

            <article class="stat-card">
              <p class="stat-label">Latest Update</p>
              <p class="stat-value" id="latestDate">--</p>
              <p class="stat-sub" id="latestSub">Reading local benchmark data...</p>
            </article>
          </section>

          <section class="resource-row" id="resourceRow" data-reveal style="--delay: 260ms" aria-label="Project Links"></section>
        </section>

        <section class="screen more-content" id="more-content" aria-label="FeatureBench Overview">
          <article class="story-panel pipeline-panel" data-reveal style="--delay: 120ms">
            <p class="story-kicker">Collection Pipeline</p>
            <div class="pipeline-layout" aria-label="Pipeline notes and dataset composition">
              <div class="pipeline-copy">
                <h3>Scalable, test-driven instance construction from repositories</h3>
                <p class="pipeline-lead">
                  FeatureBench builds feature-oriented tasks with an execution-based, test-driven pipeline. It selects
                  fail-to-pass and pass-to-pass tests, traces function dependencies, extracts feature patches, and then
                  post-verifies each instance for reproducible, continually refreshable evaluation.
                </p>
                <ul class="story-list pipeline-list">
                  <li>Dependency graphs are built via dynamic tracing rather than static heuristics.</li>
                  <li>Post verification enforces F2P fail and P2P pass conditions before patch replay.</li>
                  <li>Problem statements are synthesized with explicit interfaces and import paths.</li>
                </ul>
              </div>

              <figure class="dataset-card" aria-label="Interactive dataset composition chart">
                <div class="dataset-donut-shell">
                  <div class="dataset-chart-wrap">
                    <svg class="dataset-donut" id="datasetDonut" viewBox="0 0 420 420" role="img" aria-label="FeatureBench full split repository composition"></svg>
                    <div class="dataset-center">
                      <p class="dataset-center-kicker">FeatureBench</p>
                      <p class="dataset-center-title">Full Set</p>
                      <p class="dataset-center-sub">200 tasks</p>
                    </div>
                    <div class="dataset-tooltip" id="datasetTooltip" aria-live="polite"></div>
                  </div>
                </div>
                <p class="dataset-hover" id="datasetHoverText">Hover a slice to inspect repository and count.</p>
                <figcaption class="story-caption">Dataset composition by repository in the full split.</figcaption>
              </figure>
            </div>
          </article>
        </section>

        <section class="screen results-screen" aria-label="Empirical Results">
          <article class="story-panel results-panel no-divider" data-reveal style="--delay: 230ms">
            <p class="story-kicker">Empirical Results</p>
            <div class="results-body">
              <h3>Frontier agents still face a large feature-development gap</h3>
              <p>
                In the paper baseline, Claude Opus 4.5 reaches 74.4% resolved on SWE-bench but only 11.0% on
                FeatureBench Full, while GPT-5.1-Codex reaches 12.5%. The gap suggests current agents are still far from
                stable real-world feature shipping.
              </p>
              <div class="story-facts" aria-label="Benchmark quick facts">
                <div class="story-fact">
                  <p class="fact-value">200</p>
                  <p class="fact-label">Full tasks</p>
                </div>
                <div class="story-fact">
                  <p class="fact-value">30</p>
                  <p class="fact-label">Lite tasks</p>
                </div>
                <div class="story-fact">
                  <p class="fact-value">3825</p>
                  <p class="fact-label">Environments</p>
                </div>
                <div class="story-fact">
                  <p class="fact-value">24</p>
                  <p class="fact-label">Repositories</p>
                </div>
              </div>
              <div class="paper-table-wrap" role="region" aria-label="Paper results table" tabindex="0">
                <table class="paper-table">
                  <thead>
                    <tr>
                      <th class="paper-col-stub" rowspan="2">Scaffold</th>
                      <th class="paper-col-stub" rowspan="2">Model</th>
                      <th class="paper-group-start paper-group-head" colspan="3">Lite</th>
                      <th class="paper-group-start paper-group-head" colspan="3">Full</th>
                    </tr>
                    <tr>
                      <th class="paper-metric paper-group-start">%Passed</th>
                      <th class="paper-metric">%Resolved</th>
                      <th class="paper-metric">Token I/O</th>
                      <th class="paper-metric paper-group-start">%Passed</th>
                      <th class="paper-metric">%Resolved</th>
                      <th class="paper-metric">Token I/O</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>OpenHands</td>
                      <td>Claude Opus 4.5</td>
                      <td>67.18</td>
                      <td>20.0</td>
                      <td>8.8M / 29k</td>
                      <td>45.53</td>
                      <td>10.5</td>
                      <td>8.1M / 29k</td>
                    </tr>
                    <tr>
                      <td>Codex</td>
                      <td>GPT-5.1-Codex (medium reasoning)</td>
                      <td>60.22</td>
                      <td>20.0</td>
                      <td>6.6M / 39k</td>
                      <td>41.66</td>
                      <td>12.5</td>
                      <td>6.3M / 39k</td>
                    </tr>
                    <tr>
                      <td>Claude Code<sup>1</sup></td>
                      <td>Claude Opus 4.5</td>
                      <td>59.12</td>
                      <td>20.0</td>
                      <td>9.0M / 35k</td>
                      <td>43.29</td>
                      <td>11.0</td>
                      <td>7.5M / 34k</td>
                    </tr>
                    <tr>
                      <td>Gemini-CLI</td>
                      <td>Gemini-3-Pro-Preview (low reasoning)</td>
                      <td>43.38</td>
                      <td>10.0</td>
                      <td>2.6M / 13k</td>
                      <td>32.43</td>
                      <td>5.0</td>
                      <td>2.5M / 12k</td>
                    </tr>
                    <tr>
                      <td>OpenHands</td>
                      <td>Gemini-3-Pro-Preview (low reasoning)</td>
                      <td>45.14</td>
                      <td>10.0</td>
                      <td>6.0M / 41k</td>
                      <td>30.08</td>
                      <td>4.5</td>
                      <td>6.2M / 40k</td>
                    </tr>
                    <tr>
                      <td>OpenHands</td>
                      <td>DeepSeek-V3.2</td>
                      <td>35.94</td>
                      <td>6.7</td>
                      <td>3.1M / 24k</td>
                      <td>26.30</td>
                      <td>5.5</td>
                      <td>3.1M / 23k</td>
                    </tr>
                    <tr>
                      <td>OpenHands</td>
                      <td>Qwen3-Coder-480B-A35B-Instruct</td>
                      <td>38.31</td>
                      <td>6.7</td>
                      <td>2.6M / 16k</td>
                      <td>24.55</td>
                      <td>3.5</td>
                      <td>2.0M / 14k</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <p class="paper-footnote"><sup>1</sup> Routing mode may route operations to different models (e.g., Claude Haiku), even if a specific model is selected.</p>
            </div>
          </article>
        </section>

        <section class="screen" aria-label="Complexity and Time Analysis">
          <article class="story-panel no-divider" data-reveal style="--delay: 270ms">
            <p class="story-kicker">Complexity & Time Analysis</p>
            <h3>Pass rate varies with code complexity and task creation time</h3>
            <p>
              We also analyze how pass rate shifts across code complexity bands and temporal slices. The figure below
              summarizes pass-rate trends over lines of pending implementation and task creation periods.
            </p>
            <figure class="story-media">
              <img src="./assets/images/pass_rate.png" alt="FeatureBench pass rate versus code complexity and creation time" loading="lazy" />
              <figcaption class="story-caption">
                Pass rate vs. code complexity and creation time on FeatureBench.
              </figcaption>
            </figure>
          </article>
        </section>

        <section class="screen" aria-label="Failure Analysis">
          <article class="story-panel no-divider" data-reveal style="--delay: 310ms">
            <p class="story-kicker">Failure Analysis</p>
            <h3>Frequent failure patterns in unresolved runs</h3>
            <p>
              Failure cases cluster around implementation-level correctness and interface alignment, showing that agents
              can produce plausible code but still miss exact feature behavior required by executable tests.
            </p>
            <figure class="story-media">
              <img src="./assets/images/failure_modes.png" alt="FeatureBench failure mode statistics" loading="lazy" />
              <figcaption class="story-caption">Failure mode breakdown on FeatureBench runs.</figcaption>
            </figure>
          </article>
        </section>

        <section class="screen" aria-label="Citation">
          <article class="story-panel citation-panel no-divider" data-reveal style="--delay: 390ms">
            <p class="story-kicker">Citation</p>
            <p>Use one of the following formats when citing FeatureBench.</p>
            <div class="citation-grid" aria-label="Citation formats">
              <section class="citation-card" aria-label="BibTeX citation">
                <div class="citation-card-head">
                  <h4>BibTeX</h4>
                  <button class="citation-copy-btn" type="button" data-copy-target="cite-bibtex">Copy</button>
                </div>
                <pre class="citation-code" id="cite-bibtex">@inproceedings{zhou2026featurebench,
  title={FeatureBench: Benchmarking Agentic Coding in End-to-End Development of Complex Features},
  author={Qixing Zhou and Jiacheng Zhang and Haiyang Wang and Rui Hao and Jiahe Wang and Minghao Han and Yuxue Yang and Shuzhe Wu and Feiyang Pan and Lue Fan and Dandan Tu and Zhaoxiang Zhang},
  booktitle={International Conference on Learning Representations},
  year={2026}
}</pre>
              </section>

              <section class="citation-card" aria-label="APA citation">
                <div class="citation-card-head">
                  <h4>APA</h4>
                  <button class="citation-copy-btn" type="button" data-copy-target="cite-apa">Copy</button>
                </div>
                <pre class="citation-code" id="cite-apa">Zhou, Q., Zhang, J., Wang, H., Hao, R., Wang, J., Han, M., Yang, Y., Wu, S., Pan, F., Fan, L., Tu, D., &amp; Zhang, Z. (2026). FeatureBench: Benchmarking agentic coding in end-to-end development of complex features. In International Conference on Learning Representations (ICLR).</pre>
              </section>

              <section class="citation-card" aria-label="MLA citation">
                <div class="citation-card-head">
                  <h4>MLA</h4>
                  <button class="citation-copy-btn" type="button" data-copy-target="cite-mla">Copy</button>
                </div>
                <pre class="citation-code" id="cite-mla">Zhou, Qixing, et al. "FeatureBench: Benchmarking Agentic Coding in End-to-End Development of Complex Features." International Conference on Learning Representations (ICLR), 2026.</pre>
              </section>
            </div>
          </article>
        </section>
      </main>
      <nav class="screen-dots" id="screenDots" aria-label="Screen navigation"></nav>
    </div>

    <script>
      (function () {
        const root = document.documentElement;
        const lightBtn = document.getElementById("themeLight");
        const darkBtn = document.getElementById("themeDark");
        const themeStorageKey = "featurebench.theme";

        function applyTheme(theme) {
          const safe = theme === "dark" ? "dark" : "light";
          root.dataset.theme = safe;
          lightBtn.classList.toggle("active", safe === "light");
          darkBtn.classList.toggle("active", safe === "dark");
          lightBtn.setAttribute("aria-pressed", safe === "light" ? "true" : "false");
          darkBtn.setAttribute("aria-pressed", safe === "dark" ? "true" : "false");
          try {
            localStorage.setItem(themeStorageKey, safe);
          } catch {
            // ignore storage issues
          }
        }

        function initTheme() {
          let stored = "light";
          try {
            stored = localStorage.getItem(themeStorageKey) || "light";
          } catch {
            stored = "light";
          }
          applyTheme(stored);
        }

        function formatPercent(value) {
          const number = Number(value);
          if (!Number.isFinite(number)) return "--";
          return `${number.toFixed(2)}%`;
        }

        function formatDate(isoDate) {
          if (!isoDate) return "--";
          const date = new Date(`${isoDate}T00:00:00Z`);
          if (Number.isNaN(date.getTime())) return isoDate;
          return date.toLocaleDateString("en-US", {
            year: "numeric",
            month: "short",
            day: "2-digit",
            timeZone: "UTC",
          });
        }

        function maxNumeric(rows, key) {
          let best = null;
          for (const row of rows) {
            const value = Number(row?.[key]);
            if (!Number.isFinite(value)) continue;
            if (best === null || value > best) best = value;
          }
          return best;
        }

        async function loadSnapshot() {
          try {
            const [liteRes, fullRes] = await Promise.all([
              fetch("./leaderboard/data/lite.json", { cache: "no-store" }),
              fetch("./leaderboard/data/full.json", { cache: "no-store" }),
            ]);
            if (!liteRes.ok || !fullRes.ok) throw new Error("failed to fetch data");

            const [liteRows, fullRows] = await Promise.all([liteRes.json(), fullRes.json()]);
            const lite = Array.isArray(liteRows) ? liteRows : [];
            const full = Array.isArray(fullRows) ? fullRows : [];

            const fullResolvedBest = maxNumeric(full, "resolved");
            const fullBest = maxNumeric(full, "passed");
            const latestIso = [...lite, ...full]
              .map((item) => String(item?.date || ""))
              .filter(Boolean)
              .sort()
              .at(-1);

            document.getElementById("resolvedBest").textContent = formatPercent(fullResolvedBest);
            document.getElementById("fullBest").textContent = formatPercent(fullBest);
            document.getElementById("latestDate").textContent = formatDate(latestIso);

            document.getElementById("resolvedSub").textContent = `${full.length} runs in full split`;
            document.getElementById("fullSub").textContent = `${full.length} runs in full split`;
            document.getElementById("latestSub").textContent = "Auto-read from leaderboard data";
          } catch {
            document.getElementById("resolvedSub").textContent = "Unable to load full data";
            document.getElementById("fullSub").textContent = "Unable to load full data";
            document.getElementById("latestSub").textContent = "Serve via HTTP to load snapshot";
          }
        }

        function iconMarkup(label) {
          const key = String(label || "").toLowerCase();
          if (key.includes("arxiv") || key.includes("arvix")) {
            return '<img src="./assets/icons/arvix-logo.svg" alt="" />';
          }
          if (key.includes("docker")) {
            return '<img src="./assets/icons/docker-logo.svg" alt="" />';
          }
          if (key.includes("huggingface")) {
            return '<img src="./assets/icons/hf-logo.svg" alt="" />';
          }
          if (key.includes("github")) {
            return `
              <svg class="provider-github" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M12 .5a12 12 0 0 0-3.79 23.39c.6.11.82-.26.82-.58v-2.2c-3.34.73-4.04-1.42-4.04-1.42-.55-1.39-1.33-1.76-1.33-1.76-1.09-.74.09-.73.09-.73 1.2.08 1.83 1.23 1.83 1.23 1.08 1.84 2.82 1.31 3.5 1 .11-.78.42-1.31.76-1.61-2.67-.3-5.47-1.34-5.47-5.95 0-1.31.47-2.39 1.23-3.23-.12-.31-.53-1.54.12-3.21 0 0 1.01-.32 3.3 1.23A11.4 11.4 0 0 1 12 6.8c1.01 0 2.03.14 2.98.42 2.29-1.55 3.3-1.23 3.3-1.23.65 1.67.24 2.9.12 3.21.77.84 1.23 1.92 1.23 3.23 0 4.62-2.81 5.64-5.49 5.94.43.38.81 1.13.81 2.28v3.38c0 .32.22.7.82.58A12 12 0 0 0 12 .5Z" />
              </svg>`;
          }
          return '<span aria-hidden="true">#</span>';
        }

        async function loadResources() {
          const row = document.getElementById("resourceRow");
          if (!row) return;

          const fallback = [
            { label: "arXiv", value: "25xx.xxxxx", href: "https://arxiv.org/abs/2500.00000" },
            { label: "DockerHub", value: "Images", href: "https://hub.docker.com/u/libercoders" },
            { label: "HuggingFace", value: "datasets", href: "https://huggingface.co/datasets/LiberCoders/FeatureBench" },
            { label: "GitHub", value: "Code", href: "https://github.com/LiberCoders/FeatureBench" },
          ];

          function render(items) {
            row.innerHTML = "";
            for (const item of items) {
              const label = String(item?.label || "Link");
              const value = String(item?.value || "open");
              const a = document.createElement("a");
              a.className = "resource-pill";
              a.href = String(item?.href || "#");
              a.target = "_blank";
              a.rel = "noopener noreferrer";

              const left = document.createElement("span");
              left.className = "resource-main";

              const icon = document.createElement("span");
              icon.className = "resource-icon";
              icon.innerHTML = iconMarkup(label);

              const name = document.createElement("span");
              name.className = "resource-name";
              name.textContent = label;

              const right = document.createElement("span");
              right.className = "resource-value";
              right.textContent = value;

              left.append(icon, name);
              a.append(left, right);
              row.appendChild(a);
            }
          }

          try {
            const res = await fetch("./leaderboard/data/top_badges.json", { cache: "no-store" });
            if (!res.ok) throw new Error("failed to fetch links");
            const payload = await res.json();
            const items = Array.isArray(payload?.items) ? payload.items : [];
            render(items.length ? items : fallback);
          } catch {
            render(fallback);
          }
        }

        function initDatasetDonut() {
          const svg = document.getElementById("datasetDonut");
          if (!svg) return;

          const tooltip = document.getElementById("datasetTooltip");
          const hoverText = document.getElementById("datasetHoverText");
          const wrap = svg.closest(".dataset-chart-wrap");
          const defaultHover = "Hover a slice to inspect repository and count.";

          const data = [
            { label: "mlflow", count: 49 },
            { label: "transformers", count: 34 },
            { label: "pandas", count: 20 },
            { label: "astropy", count: 17 },
            { label: "pytorch-lightning", count: 12 },
            { label: "seaborn", count: 12 },
            { label: "sphinx", count: 10 },
            { label: "Liger-Kernel", count: 7 },
            { label: "sympy", count: 6 },
            { label: "xarray", count: 6 },
            { label: "pydantic", count: 5 },
            { label: "scikit-learn", count: 3 },
            { label: "Others", count: 19 },
          ];

          const total = data.reduce((sum, item) => sum + item.count, 0);
          if (!total) return;

          const NS = "http://www.w3.org/2000/svg";
          const cx = 210;
          const cy = 210;
          const outerRadius = 196;
          const innerRadius = 94;

          const colors = [
            "#9eb6d2",
            "#e3aeb6",
            "#e3ccaa",
            "#e4e5aa",
            "#a8e4b3",
            "#a8c8e6",
            "#b9a7cc",
            "#dcb4b4",
            "#e5d491",
            "#9ac2de",
            "#9fd3c8",
            "#d8b8b8",
            "#ced7e0",
          ];

          function polarToCartesian(centerX, centerY, radius, angleDeg) {
            const rad = ((angleDeg - 90) * Math.PI) / 180;
            return {
              x: centerX + radius * Math.cos(rad),
              y: centerY + radius * Math.sin(rad),
            };
          }

          function buildArcPath(startAngle, endAngle) {
            const safeEnd = Math.min(endAngle, startAngle + 359.999);
            const startOuter = polarToCartesian(cx, cy, outerRadius, startAngle);
            const endOuter = polarToCartesian(cx, cy, outerRadius, safeEnd);
            const startInner = polarToCartesian(cx, cy, innerRadius, startAngle);
            const endInner = polarToCartesian(cx, cy, innerRadius, safeEnd);
            const largeArcFlag = safeEnd - startAngle > 180 ? 1 : 0;

            return [
              "M",
              startOuter.x,
              startOuter.y,
              "A",
              outerRadius,
              outerRadius,
              0,
              largeArcFlag,
              1,
              endOuter.x,
              endOuter.y,
              "L",
              endInner.x,
              endInner.y,
              "A",
              innerRadius,
              innerRadius,
              0,
              largeArcFlag,
              0,
              startInner.x,
              startInner.y,
              "Z",
            ].join(" ");
          }

          function showTooltip(text, clientX, clientY) {
            if (!tooltip || !wrap) return;
            tooltip.textContent = text;
            tooltip.classList.add("visible");

            let x = wrap.clientWidth / 2 - tooltip.offsetWidth / 2;
            let y = 12;
            if (Number.isFinite(clientX) && Number.isFinite(clientY)) {
              const rect = wrap.getBoundingClientRect();
              x = clientX - rect.left + 12;
              y = clientY - rect.top + 12;
            }

            const maxX = Math.max(8, wrap.clientWidth - tooltip.offsetWidth - 8);
            const maxY = Math.max(8, wrap.clientHeight - tooltip.offsetHeight - 8);
            const clampedX = Math.max(8, Math.min(x, maxX));
            const clampedY = Math.max(8, Math.min(y, maxY));
            tooltip.style.left = clampedX + "px";
            tooltip.style.top = clampedY + "px";
          }

          function hideTooltip() {
            if (!tooltip) return;
            tooltip.classList.remove("visible");
            tooltip.style.left = "0px";
            tooltip.style.top = "0px";
          }

          const slices = [];
          function clearActive() {
            for (const slice of slices) {
              slice.classList.remove("active");
            }
          }

          function activate(slice, item, event) {
            clearActive();
            slice.classList.add("active");
            const pct = ((item.count / total) * 100).toFixed(1);
            const text = `${item.label}: ${item.count} tasks (${pct}%)`;
            if (hoverText) hoverText.textContent = text;
            showTooltip(
              text,
              Number.isFinite(event?.clientX) ? event.clientX : null,
              Number.isFinite(event?.clientY) ? event.clientY : null
            );
          }

          function deactivate() {
            clearActive();
            if (hoverText) hoverText.textContent = defaultHover;
            hideTooltip();
          }

          svg.innerHTML = "";
          let cursor = 0;
          data.forEach((item, index) => {
            const sweep = (item.count / total) * 360;
            const start = cursor;
            const end = cursor + sweep;
            cursor = end;

            const path = document.createElementNS(NS, "path");
            path.setAttribute("d", buildArcPath(start, end));
            path.setAttribute("fill", colors[index % colors.length]);
            path.setAttribute("class", "dataset-slice");
            path.setAttribute(
              "aria-label",
              `${item.label}, ${item.count} tasks, ${((item.count / total) * 100).toFixed(1)} percent`
            );

            path.addEventListener("mouseenter", (event) => activate(path, item, event));
            path.addEventListener("mousemove", (event) => activate(path, item, event));
            path.addEventListener("mouseleave", () => deactivate());

            slices.push(path);
            svg.appendChild(path);
          });
        }

        function initCitationCopy() {
          const buttons = Array.from(document.querySelectorAll(".citation-copy-btn"));
          if (!buttons.length) return;

          async function writeClipboard(text) {
            if (navigator.clipboard && typeof navigator.clipboard.writeText === "function") {
              await navigator.clipboard.writeText(text);
              return;
            }

            const textarea = document.createElement("textarea");
            textarea.value = text;
            textarea.setAttribute("readonly", "");
            textarea.style.position = "fixed";
            textarea.style.top = "0";
            textarea.style.left = "-9999px";
            document.body.appendChild(textarea);
            textarea.focus();
            textarea.select();
            document.execCommand("copy");
            textarea.remove();
          }

          for (const button of buttons) {
            const defaultText = button.textContent || "Copy";
            let timerId = null;

            button.addEventListener("click", async () => {
              const targetId = button.getAttribute("data-copy-target");
              const target = targetId ? document.getElementById(targetId) : null;
              if (!target) return;

              try {
                const text = (target.textContent || "").trim();
                await writeClipboard(text);
                button.textContent = "Copied";
                button.setAttribute("data-copied", "true");
              } catch {
                button.textContent = "Failed";
                button.removeAttribute("data-copied");
              }

              if (timerId) {
                clearTimeout(timerId);
              }
              timerId = setTimeout(() => {
                button.textContent = defaultText;
                button.removeAttribute("data-copied");
              }, 1400);
            });
          }
        }

        function initScreenDots() {
          const scroller = document.getElementById("slides");
          const dotsRoot = document.getElementById("screenDots");
          if (!scroller || !dotsRoot) return;

          const screens = Array.from(scroller.querySelectorAll(":scope > .screen"));
          if (!screens.length) {
            dotsRoot.hidden = true;
            return;
          }

          const reduceMotion =
            window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;
          const supportsWheelSnap =
            window.matchMedia && window.matchMedia("(pointer: fine)").matches;

          let activeIndex = 0;
          let wheelLocked = false;
          let scrollTicking = false;

          function clampIndex(index) {
            return Math.max(0, Math.min(index, screens.length - 1));
          }

          function nearestIndex() {
            const top = scroller.scrollTop;
            let bestIndex = 0;
            let bestDistance = Infinity;
            for (let i = 0; i < screens.length; i += 1) {
              const distance = Math.abs(screens[i].offsetTop - top);
              if (distance < bestDistance) {
                bestDistance = distance;
                bestIndex = i;
              }
            }
            return bestIndex;
          }

          dotsRoot.innerHTML = "";
          const buttons = screens.map((screen, index) => {
            const button = document.createElement("button");
            button.type = "button";
            button.className = "screen-dot";
            button.setAttribute("aria-label", `Go to screen ${index + 1}`);
            button.addEventListener("click", () => {
              goToIndex(index);
            });
            dotsRoot.appendChild(button);
            return button;
          });

          function setActive(index) {
            buttons.forEach((button, i) => {
              const active = i === index;
              button.classList.toggle("active", active);
              button.setAttribute("aria-current", active ? "true" : "false");
            });
          }

          function goToIndex(index, options = {}) {
            const targetIndex = clampIndex(index);
            activeIndex = targetIndex;
            setActive(activeIndex);
            const targetTop = screens[targetIndex].offsetTop;
            if (options.instant || reduceMotion) {
              scroller.scrollTop = targetTop;
              return Promise.resolve();
            }
            scroller.scrollTo({ top: targetTop, behavior: "smooth" });
            return Promise.resolve();
          }

          function syncActiveOnScroll() {
            if (scrollTicking) return;
            scrollTicking = true;
            requestAnimationFrame(() => {
              activeIndex = nearestIndex();
              setActive(activeIndex);
              scrollTicking = false;
            });
          }

          scroller.addEventListener("scroll", syncActiveOnScroll, { passive: true });

          if (supportsWheelSnap) {
            scroller.addEventListener(
              "wheel",
              (event) => {
                if (Math.abs(event.deltaY) < 4) return;
                event.preventDefault();
                if (wheelLocked) return;

                const direction = event.deltaY > 0 ? 1 : -1;
                const fromIndex = nearestIndex();
                const toIndex = clampIndex(fromIndex + direction);
                if (toIndex === fromIndex) return;

                wheelLocked = true;
                goToIndex(toIndex)
                  .catch(() => {})
                  .finally(() => {
                    setTimeout(() => {
                      wheelLocked = false;
                    }, 700);
                  });
              },
              { passive: false }
            );
          }

          window.addEventListener("resize", () => {
            activeIndex = nearestIndex();
            goToIndex(activeIndex, { instant: true });
          });

          const hash = window.location.hash;
          if (hash) {
            const target = document.querySelector(hash);
            if (target && scroller.contains(target)) {
              const targetScreen = target.closest(".screen") || target;
              const targetIndex = screens.indexOf(targetScreen);
              goToIndex(targetIndex >= 0 ? targetIndex : 0, { instant: true });
              return;
            }
          }

          goToIndex(0, { instant: true });
        }

        initTheme();
        lightBtn.addEventListener("click", () => applyTheme("light"));
        darkBtn.addEventListener("click", () => applyTheme("dark"));

        initScreenDots();
        loadSnapshot();
        loadResources();
        initDatasetDonut();
        initCitationCopy();
      })();
    </script>
  </body>
</html>
